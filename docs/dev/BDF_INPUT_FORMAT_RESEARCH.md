# BDF 输入格式研究文档

## 📋 研究目标

1. **理解 BDF 输入文件结构**：了解 BDF 输入文件的基本格式和语法
2. **识别关键字段**：找出必需和可选的关键字段
3. **建立映射关系**：建立我们的 YAML 格式到 BDF 格式的映射
4. **收集示例**：收集各种计算类型的 BDF 输入文件示例
5. **文档化**：记录所有发现，便于后续开发

## 🔍 需要研究的内容

### 1. 基本结构

- [ ] BDF 输入文件的整体结构
- [ ] 文件格式（文本格式、行格式、块格式等）
- [ ] 注释方式
- [ ] 关键字格式（大小写敏感性、缩写等）

### 2. 分子结构输入

- [ ] 坐标输入格式（笛卡尔坐标、内坐标）
- [ ] 单位（Angstrom、Bohr）
- [ ] 电荷和自旋多重度指定方式
- [ ] 对称性处理

### 3. 计算方法指定

- [ ] DFT 泛函指定方式
- [ ] Hartree-Fock 方法指定
- [ ] 后 HF 方法（MP2、CCSD 等）
- [ ] 基组指定方式
- [ ] 基组库位置

### 4. 计算类型

- [ ] 单点能计算
- [ ] 几何优化
- [ ] 频率计算
- [ ] 激发态计算（TD-DFT）
- [ ] 其他计算类型

### 5. 计算参数

- [ ] SCF 收敛标准
- [ ] 积分网格设置
- [ ] 几何优化参数
- [ ] 其他高级参数

## 📝 研究方法和步骤

### 步骤 1：收集 BDF 输入文件示例

**目标**：收集各种类型的 BDF 输入文件

**方法**：
1. 从 BDF 用户手册中查找示例
2. 从已有的计算任务中收集
3. 从 BDF 测试用例中收集
4. 从 BDF 用户社区收集

**存储位置**：`research/bdf_examples/`

### 步骤 2：分析输入文件结构

**目标**：理解 BDF 输入文件的基本结构

**方法**：
1. 逐个分析收集到的示例文件
2. 识别共同的结构模式
3. 记录关键字段和格式

### 步骤 3：建立映射表

**目标**：建立 YAML → BDF 的映射关系

**方法**：
1. 对比我们的 YAML 格式和 BDF 格式
2. 建立字段映射关系
3. 记录转换规则

### 步骤 4：验证和测试

**目标**：验证映射关系的正确性

**方法**：
1. 手动转换几个示例
2. 使用 BDF 验证转换后的输入文件
3. 修正映射关系

## 📂 文件组织

```
research/
├── bdf_examples/              # BDF 输入文件示例
│   ├── energy/                # 单点能计算示例
│   │   ├── h2o_pbe0.inp
│   │   ├── benzene_hf.inp
│   │   └── ...
│   ├── optimize/              # 几何优化示例
│   │   ├── h2o_opt.inp
│   │   └── ...
│   ├── frequency/             # 频率计算示例
│   │   └── ...
│   └── tddft/                # 激发态计算示例
│       └── ...
├── mapping_tables/            # 映射表
│   ├── method_mapping.yaml    # 方法映射表
│   ├── basis_mapping.yaml     # 基组映射表
│   └── keyword_mapping.yaml   # 关键词映射表
├── notes/                     # 研究笔记
│   ├── structure_analysis.md  # 结构分析笔记
│   ├── field_reference.md     # 字段参考
│   └── findings.md            # 发现和问题
└── converted/                 # 转换后的示例（用于验证）
    └── ...
```

## 📊 研究记录模板

### BDF 输入文件分析记录

**文件名**：`h2o_pbe0.inp`  
**计算类型**：单点能  
**方法**：PBE0/cc-pVDZ  
**日期**：2024-01-XX

#### 文件内容
```
[粘贴 BDF 输入文件内容]
```

#### 结构分析
- **文件格式**：文本文件，行格式
- **注释方式**：`#` 或 `!`
- **关键字格式**：大写/小写/混合
- **块结构**：是否有块结构

#### 关键字段识别
| 字段 | BDF 关键词 | 位置 | 格式 | 说明 |
|------|-----------|------|------|------|
| 分子坐标 | `$coord` | ... | ... | ... |
| 电荷 | `$charge` | ... | ... | ... |
| 自旋 | `$spin` | ... | ... | ... |
| 方法 | `$method` | ... | ... | ... |
| 基组 | `$basis` | ... | ... | ... |

#### 映射关系
| YAML 字段 | BDF 关键词 | 转换规则 |
|-----------|-----------|----------|
| `molecule.coordinates` | `$coord` | 格式转换 |
| `molecule.charge` | `$charge` | 直接映射 |
| `method.functional` | `$method` | 名称映射 |

#### 注意事项
- 特殊要求
- 常见错误
- 最佳实践

## 🔑 关键研究点

### 1. 坐标输入格式

**需要确认**：
- [ ] 坐标格式（自由格式、固定格式）
- [ ] 单位指定方式
- [ ] 坐标块的结构
- [ ] 是否支持内坐标

**示例记录**：
```
[记录坐标输入的具体格式]
```

### 2. 方法指定

**需要确认**：
- [ ] DFT 泛函名称（PBE0、B3LYP 等）
- [ ] 方法关键词格式
- [ ] 混合泛函的指定方式
- [ ] 后 HF 方法的指定

**映射表**：
```yaml
# method_mapping.yaml
methods:
  pbe0:
    bdf_keyword: "PBE0"
    type: "hybrid_dft"
  b3lyp:
    bdf_keyword: "B3LYP"
    type: "hybrid_dft"
  hf:
    bdf_keyword: "HF"
    type: "wavefunction"
```

### 3. 基组指定

**需要确认**：
- [ ] 基组名称格式
- [ ] 基组库位置
- [ ] 自定义基组方式
- [ ] 基组文件格式

**映射表**：
```yaml
# basis_mapping.yaml
basis_sets:
  cc-pvdz:
    bdf_name: "cc-pVDZ"
    library_path: "..."
  "6-31g*":
    bdf_name: "6-31G*"
    library_path: "..."
```

### 4. 计算类型

**需要确认**：
- [ ] 单点能计算的关键词
- [ ] 几何优化的关键词
- [ ] 频率计算的关键词
- [ ] 其他计算类型

**映射表**：
```yaml
# task_mapping.yaml
task_types:
  energy:
    bdf_keyword: "ENERGY"
    required_fields: [...]
  optimize:
    bdf_keyword: "OPTIMIZE"
    required_fields: [...]
  frequency:
    bdf_keyword: "FREQUENCY"
    required_fields: [...]
```

## 📖 参考资源

### BDF 官方文档

- [ ] BDF 用户手册
- [ ] BDF 开发者文档
- [ ] BDF 示例库
- [ ] BDF 常见问题

### 其他资源

- [ ] BDF 用户社区
- [ ] BDF 邮件列表
- [ ] 相关论文和教程

## 🎯 研究检查清单

### 基础研究
- [ ] 收集至少 5 个不同类型的 BDF 输入文件示例
- [ ] 分析 BDF 输入文件的基本结构
- [ ] 识别所有关键字段
- [ ] 理解文件格式和语法规则

### 映射建立
- [ ] 建立方法映射表（至少 10 种方法）
- [ ] 建立基组映射表（至少 10 种基组）
- [ ] 建立任务类型映射表
- [ ] 建立参数映射表

### 验证
- [ ] 手动转换 3 个示例
- [ ] 验证转换后的文件能被 BDF 识别
- [ ] 修正发现的映射错误

## 📝 研究笔记区域

### 发现的问题

1. **问题 1**：[描述]
   - 发现时间：
   - 影响：
   - 解决方案：

2. **问题 2**：[描述]
   - ...

### 重要发现

1. **发现 1**：[描述]
   - 重要性：
   - 应用：

2. **发现 2**：[描述]
   - ...

### 待确认事项

- [ ] 事项 1
- [ ] 事项 2
- [ ] ...

## 🔄 持续更新

本文档应该随着研究的深入持续更新：
- 添加新的发现
- 更新映射表
- 记录问题和解决方案
- 补充示例

---

**开始研究前**：请先收集 BDF 输入文件示例，然后逐步分析。

**研究过程中**：及时记录所有发现，便于后续开发参考。

**研究完成后**：整理成完整的映射表和参考文档。

